<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting…</title>
  </head>
  <body>
    <p>Redirecting to the application…</p>
    <script>
      (function() {
        var l = window.location;
        var base = '/Workspace'; // must match vite.config.js base
        // number of segments to keep from the start ("" and "Workspace")
        var keep = base.replace(/^\/+|\/+$/g, '').split('/').filter(Boolean).length; // 1 for "/Workspace"
        var parts = l.pathname.split('/');
        // build the path after the base
        var tail = parts.slice(1 + keep).join('/');
        var p = '/' + tail;
        // encode original query separately so we can restore it on index.html
        var q = l.search ? l.search.slice(1).replace(/&/g, '~and~') : '';
        var h = l.hash ? l.hash.slice(1) : '';
        var target = l.protocol + '//' + l.host + base + '/?p=' + encodeURIComponent(p) + (q ? '&q=' + encodeURIComponent(q) : '') + (h ? '&h=' + encodeURIComponent(h) : '');
        l.replace(target);
      })();
    </script>
  </body>
</html>
